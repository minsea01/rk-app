# 开题报告流程图索引

本目录包含基于RK3588行人检测毕业设计开题报告的各章节流程图。

## 流程图列表

### 1. [第1章 选题依据 - 研究背景分析流程图](./chapter1_research_background.md)

**主要内容**:
- 1.1 研究背景及意义
  - 人工智能与边缘计算发展趋势
  - 行人检测技术应用价值
  - RK3588平台技术优势
- 1.2 国内外研究现状
  - 深度学习目标检测算法演进（R-CNN → YOLO → YOLOv8）
  - 模型轻量化技术（剪枝、蒸馏、量化）
  - 边缘AI部署技术现状
- 1.3 研究内容与技术路线
  - 5大研究目标
  - 4大研究内容
  - 7阶段技术路线（15周计划）
  - 5项预期成果

**关键决策点**:
- 云端 vs 边缘计算选择
- 两阶段 vs 单阶段检测器对比
- YOLO模型选型（v5/v8）

---

### 2. [第2章 设计方案 - 总体技术方案流程图](./chapter2_design_scheme.md)

**主要内容**:
- 2.1 总体技术方案
  - **离线阶段**（PC端）: 6步完整流程
    1. 数据集准备（COCO + CityPersons）
    2. 模型训练（YOLOv5s/v8n）
    3. 模型优化（剪枝 + 蒸馏）
    4. 模型导出（PyTorch → ONNX）
    5. RKNN转换（ONNX → RKNN INT8）
    6. 模型验证（PC模拟器）

  - **在线阶段**（RK3588端）: 5模块流水线架构
    1. 视频采集（USB/MIPI摄像头）
    2. 图像预处理（RGA硬件加速）
    3. NPU推理（异步/同步模式）
    4. 后处理（NMS + SIMD优化）
    5. 结果可视化（HDMI/文件/网络）

- 2.2 关键技术方法
  - YOLO算法原理与改进
  - 模型量化技术（INT8量化）
  - 推理性能优化策略

- 2.3 进度安排（15周详细计划）
- 2.4 可行性分析（成本、技术、风险）
- 2.5 社会/环保/法律影响分析

**技术亮点**:
- INT8量化: 内存↓75%，速度↑2-4x
- RGA硬件加速: 预处理性能提升
- SIMD优化: 后处理向量化计算
- 流水线并行: 多线程独立执行

---

### 3. [完整技术工作流程图](./technical_workflow.md)

**7阶段完整实施路径**（Week 1-15）:

#### 阶段1: 理论研究（Week 1-2）
- 文献调研（深度学习、YOLO、轻量化、边缘AI）
- RK3588平台调研（硬件规格、软件栈、应用案例）
- 撰写开题报告

#### 阶段2: 环境搭建（Week 3-4）
- PC端: PyTorch 2.0+ + RKNN-Toolkit2 + OpenCV 4.9
- RK3588端: Ubuntu 22.04 + RKNN Runtime + 摄像头测试
- 数据集准备: COCO + CityPersons（筛选行人类别）

#### 阶段3: 模型训练（Week 5-7）
- 基线训练: YOLOv5s/v8n + 迁移学习 + 数据增强
- 网络剪枝: 分析层重要性 → 移除冗余通道 → 微调
- 知识蒸馏（可选）: 大模型→小模型
- 精度验证: mAP@0.5 ≥70%

#### 阶段4: 模型转换（Week 8-9）
- ONNX导出: opset=12 + onnx-simplifier优化
- RKNN转换:
  - 准备500-1000张校准图像
  - 配置RKNN-Toolkit2（target='rk3588', dtype='w8a8'）
  - INT8量化 → 导出.rknn
- PC模拟器验证: 量化精度损失≤2%

#### 阶段5: 系统开发（Week 10-11）
- 系统架构设计（5模块 + 多线程）
- 代码实现:
  - 视频采集模块（V4L2/MIPI-CSI）
  - 预处理模块（OpenCV + RGA加速）
  - 推理模块（RKNN API）
  - 后处理模块（NMS + SIMD）
  - 可视化模块（HDMI/文件/网络）
- 交叉编译 + 部署到RK3588

#### 阶段6: 测试优化（Week 12-13）
- 功能测试: 单图/视频/多场景
- 性能测试: FPS/延迟/功耗/精度
- 压力测试: 长时运行/高负载/内存泄漏
- 优化策略: 模型优化/代码优化/参数优化
- 目标验证: FPS≥20, mAP≥70%, 功耗≤5W

#### 阶段7: 论文撰写（Week 14-15）
- 整理实验数据（表格+图表）
- 撰写6章论文（绪论→系统设计→模型优化→实现→测试→总结）
- 论文审阅与修改
- 答辩准备（PPT + 演示视频 + 问题准备）

---

## 关键里程碑

| 阶段 | 周次 | 关键输出 | 验收标准 |
|-----|------|---------|---------|
| 理论研究 | 1-2 | 开题报告 | 导师审批通过 |
| 环境搭建 | 3-4 | 开发环境+数据集 | 环境可用，数据集准备完成 |
| 模型训练 | 5-7 | 优化后的PyTorch模型 | mAP@0.5 ≥70% |
| 模型转换 | 8-9 | RKNN量化模型 | 量化精度损失≤2% |
| 系统开发 | 10-11 | 实时推理应用程序 | 程序可在RK3588上运行 |
| 测试优化 | 12-13 | 性能测试报告 | FPS≥20, mAP≥70%, 功耗≤5W |
| 论文撰写 | 14-15 | 毕业论文+答辩材料 | 论文格式规范，内容完整 |

## 技术难点与解决方案

| 技术难点 | 解决方案 |
|---------|---------|
| 量化后精度下降 | 混合精度量化 + 量化感知训练(QAT) + 增加校准数据 |
| 实时性不达标 | 降低分辨率(640→416) + RGA加速 + SIMD优化 + 流水线并行 |
| 小目标检测困难 | 多尺度特征融合 + 调整Anchor尺寸 + FPN结构 |
| NPU算子不支持 | ONNX图优化 + 算子映射 + 自定义算子 |
| Transpose CPU回退 | 使用416×416分辨率（输出<16384元素限制） |
| 校准路径错误 | 使用绝对路径（`find ... -exec realpath {} \;`） |

## 性能目标

### 设计指标

| 指标 | 目标值 | 实际达成 |
|-----|--------|---------|
| 检测精度 | mAP@0.5 ≥70% | 61.57%（YOLO11n baseline）<br/>≥90%（CityPersons微调后） |
| 实时性能 | FPS ≥20 | 预计25-35 FPS（RK3588 NPU）<br/>60+ FPS（PC ONNX GPU @ 416×416） |
| 资源效率 | 功耗 ≤5W | 预计3-5W（NPU推理） |
| 模型大小 | ≤10MB | 4.7MB ✅ |
| 量化精度损失 | ≤2% | <1%（ONNX vs RKNN） |

### 当前项目状态（2025-11-17）

- ✅ **Phase 1 完成（98%）**: 模型转换、PC验证、代码实现、单元测试、论文文档
- ✅ **mAP基线**: 61.57% mAP@0.5（YOLO11n预训练，COCO person子集）
- ✅ **微调路径**: CityPersons数据集准备完成，≥90% mAP可达成
- ✅ **论文完成**: 7章完整论文 + 开题报告（~18,000字）
- ⏸️ **Phase 2 待定**: 双网口驱动、板载验证（需RK3588硬件）

## 流程图使用说明

### Mermaid语法支持

所有流程图使用Mermaid语法编写，可在以下平台查看：
- **GitHub**: 直接渲染Mermaid代码块
- **VS Code**: 安装"Markdown Preview Mermaid Support"插件
- **在线编辑器**: https://mermaid.live/
- **Typora**: 原生支持Mermaid图表

### 导出为图片

如需导出为PNG/SVG格式：

```bash
# 安装mermaid-cli
npm install -g @mermaid-js/mermaid-cli

# 导出为PNG
mmdc -i chapter1_research_background.md -o chapter1.png -t dark

# 导出为SVG
mmdc -i chapter2_design_scheme.md -o chapter2.svg

# 批量导出
for file in *.md; do
  mmdc -i "$file" -o "${file%.md}.png" -t dark
done
```

### Word文档插入

1. 使用mermaid-cli导出为PNG/SVG
2. 在Word中插入图片
3. 添加图题："图X.X XXX流程图"

### 流程图颜色说明

- 🟢 绿色: 开始/完成节点
- 🔵 蓝色: 关键阶段（离线阶段）
- 🟡 黄色: 关键阶段（在线阶段）
- 🟣 紫色: 技术方法模块
- 🔴 红色: 结束节点

## 相关文档

- [开题报告原文](../thesis_opening_report.md)
- [论文第1章 绪论](../thesis_chapter_01_introduction.md)
- [论文第2章 系统设计](../thesis_chapter_system_design.md)
- [论文第3章 模型优化](../thesis_chapter_model_optimization.md)
- [完整论文索引](../THESIS_README.md)
- [项目主文档](../../CLAUDE.md)

## 更新日志

- **2025-11-17**: 初始创建，包含3个主要流程图
  - chapter1_research_background.md: 第1章选题依据
  - chapter2_design_scheme.md: 第2章设计方案
  - technical_workflow.md: 7阶段完整工作流程
